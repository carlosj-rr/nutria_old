source("~/scripts/R_concat_func.R")
someGeneList<-read.csv("someGeneList.csv",header=T)
someGeneList
sppClTable<-read.csv("sppClTable.csv",header=T)
aa_someGeneList<-read.csv("someGeneList_AA.csv",header=T)
sppClTable
aa_someGeneList
q()
someGeneList<-read.csv("someGeneList.csv",header=T)
aa_someGeneList<-read.csv("someGeneList_AA.csv",header=T)
concatInPhy(someGeneList,sppClTable,"Concat_inNucs.phy")
library(ape)
library(adephylo)
concatInPhy(someGeneList,sppClTable,"Concat_inNucs.phy")
concatInPhy(aa_someGeneList,sppClTable,"Concat_inAAs.phy")
concat_nucs<-read.dna("Concat_inNucs.phy")
concat_aas<-read.dna("Concat_inAAs.phy")
concat_aas
concat_nucs<-read.dna("Concat_inNucs.phy",as.character=T)
concat_aas<-read.dna("Concat_inAA.phy",as.character=T)
concat_aas<-read.dna("Concat_inAAs.phy",as.character=T)
head(concat_nucs)
head(concat_aas)
concat_aas[0:5,]
concat_aas[,0:5]
factor(concat_aas[,0:5])
concat_nucs[,0:5]
factors(concat_nucs[,0:5])
factor(concat_nucs[,0:5])
q()
install.packages("entropy")
install.packages("dplyr")
q()
library(adephylo)
library(entropy)
concat_nucs
concat_nucs[,1]
bases<-c("A","T","G","C")
bases
concat_nucs[,1]
concat_nucs[,1] == bases[1]
toupper(concat_nucs[,1]) == bases[1]
bases[1]
toupper(concat_nucs[,1]) == bases[2]
toupper(concat_nucs[,1]) == bases[3]
toupper(concat_nucs[,1]) == bases[4]
bases
toupper(bases)
toupper(concat_nucs)
type="nuc"
print(paste("Your \"type\" input, ",type,"is invalid. Please use \"nuc\" or \"aa\"),sep="")
print(paste("Your "type" input, ",type,"is invalid. Please use \"nuc\" or \"aa\"",sep=""))
print(paste("Your \"type\" input, ",type,"is invalid. Please use \"nuc\" or \"aa\"",sep=""))
print(paste("Your \"type\" input: ",type," is invalid. Please use \"nuc\" or \"aa\"",sep=""))
toupper(concat_nucs[,1]) == bases[4]
sum(toupper(concat_nucs[,1]) == bases[4])
source("~/scripts/sequence_entropy_calculator.R")
source("~/scripts/sequence_entropy_calculator.R")
concat_nucs[1,]
concat_nucs[,1]
concat_nucs[,2]
concat_nucs[,3]
concat_nucs[,4]
calcSiteEntropy(concat_nucs[,1])
source("~/scripts/sequence_entropy_calculator.R")
calcSiteEntropy(concat_nucs[,1])
concat_nucs[,1]
concat_nucs[,2]
calcSiteEntropy(concat_nucs[,2])
calcSiteEntropy(concat_nucs[,4])
concat_nucs[,4]
?entropy.empirical
source("~/scripts/sequence_entropy_calculator.R")
calcSiteEntropy(concat_nucs[,4])
calcSiteEntropy(concat_nucs[,1])
calcSiteEntropy(concat_nucs[,2])
calcSiteEntropy(concat_nucs[,3])
calcSiteEntropy(concat_nucs[,4])
calcSiteEntropy(concat_nucs[,5])
calcSiteEntropy(c("A","T","G","C"))
x<-sapply(calcSiteEntropy,concat_nucs[,1:ncol(concat_nucs)])
concat_nucs[,1:ncol(concat_nucs)]
c(concat_nucs[,1:ncol(concat_nucs)])
x<-sapply(calcSiteEntropy,concat_nucs[,1:ncol(concat_nucs)])
?sapply
x<-sapply(concat_nucs[,1:ncol(concat_nucs)],calcSiteEntropy)
x
x<-c(); for (i in 1:ncol(concat_nucs)) { x[i]<-calcSiteEntropy(concat_nucs[,i]}
x<-c(); for (i in 1:ncol(concat_nucs)) { x[i]<-calcSiteEntropy(concat_nucs[,i]) }
x
plot(x)
bat(x)
bar(x)
?bar
q()
ls()
x
plot(x[1:6000])
abline(v=1500)
abline(v=1500,col="red")
abline(v=3000,col="red")
abline(v=4500,col="red")
plot(x[1:9000])
abline(v=1500,col="red")
abline(v=3000,col="red")
abline(v=4500,col="red")
abline(v=6000,col="red")
abline(v=7500,col="red")
hist(x[1:1500])
hist(x[1501:3000])
hist(x[3001:4500])
hist(x[4501:6000])
hist(x[6001:7500])
q()
library(ape)
fileName<-"Some_fasta_file.fas"
fileName1<-"Some_fasta_file.fas"
fileName2<-"Some_fasta_file.fasta"
fileName3<-"Some_fasta_file.fasta"
fileName3<-"Some_phylip_file.phy"
str(fileName)
strsplit(fileName)
strsplit(fileName,".")
strsplit(fileName,"\.")
strsplit(fileName," ")
strsplit(fileName,"_")
strsplit(fileName,"\\.")
strsplit(fileName,"\\.")[1]
strsplit(fileName,"\\.")[[2]]
strsplit(fileName,"\\.")[2]
strsplit(fileName,"\\.")
strsplit(fileName,"\\.")[[1]][2]
tail(strsplit(fileName,"\\."),n=1)
tail(strsplit(fileName,"\\.")[[1]],n=1)
toupper(tail(strsplit(fileName,"\\.")[[1]],n=1))
tolower(tail(strsplit(fileName,"\\.")[[1]],n=1))
inseq<-read.dna("CodeSeq_test1_onCortex_4seq_gene10.fas")
?read.dna
inseq<-read.FASTA("CodeSeq_test1_onCortex_4seq_gene10.fas")
inseq
as.character(inseq)
as.data.frame(as.character(inseq))
t(as.data.frame(as.character(inseq)))
inseq1<-t(as.data.frame(as.character(inseq)))
inseq2<-read.dna("CodeSeq_test1_onCortex_4seq_gene10.phy",as.character=T)
inseq2<-read.dna("CodeSeq_test1_onCortex_4seq_gene1.phy",as.character=T)
inseq2
inseq<-read.FASTA("CodeSeq_test1_onCortex_4seq_gene1.fas")
inseq1<-t(as.data.frame(as.character(inseq)))
inseq1
inseq2
inseq1 == inseq2
all(inseq1 == inseq2)
inseq<-read.FASTA("CodeSeq_test1_onCortex_4seq_gene1_AA.fas")
inseq1<-t(as.data.frame(as.character(inseq)))
inseq
as.character(inseq)
inseq<-read.FASTA("CodeSeq_test1_onCortex_4seq_gene1_AA.fas",type="aa")
inseq1<-t(as.data.frame(as.character(inseq)))
inseq1
?read.FASTA
inNucs<-read.FASTA("CodeSeq_test1_onCortex_4seq_gene1.fas",type="DNA")
inNucs<-read.FASTA("CodeSeq_test1_onCortex_4seq_gene1.fas",type="AA")
inNucs == inNucs
inNucs
inNucs<-read.FASTA("CodeSeq_test1_onCortex_4seq_gene1.fas",type="DNA")
inAAs<-read.FASTA("CodeSeq_test1_onCortex_4seq_gene1.fas",type="AA")
inNucs
inAAs
str(inAAs)
str(inNucs)
as.character(inNucs)
as.factor(inNucs)
as.data.frame(as.character(inNucs))
t(as.data.frame(as.character(inNucs)))
as.factors(t(as.data.frame(as.character(inNucs))))
as.factor(t(as.data.frame(as.character(inNucs))))
x<-as.factor(t(as.data.frame(as.character(inNucs))))
str(x)
levels(x)
y<-as.factor(t(as.data.frame(as.character(inAAs))))
levels(x)
levels(as.factor(t(as.data.frame(as.character(inAAs)))))
levels(as.factor(t(as.data.frame(as.character(inNucs)))))
fasSeqType<-function(fileName) {
  inNucs<-read.FASTA(fileName,type="DNA")
  inAAs<-read.FASTA(fileName,type="AA")
  levelsInNuc<-levels(as.factor(t(as.data.frame(as.character(inNucs)))))
  levelsInAas<-levels(as.factor(t(as.data.frame(as.character(inAAs)))))
  if ( length(levelsInNuc) == length(levelsInAas) ) {
    type="DNA"
  } else {
    type="AA"
  }
  return(type)
}
fasSeqType("CodeSeq_test1_onCortex_4seq_gene1_AA.fas")
inAAs
fasSeqType("CodeSeq_test1_onCortex_4seq_gene1.fas")
inNucs<-read.FASTA("CodeSeq_test1_onCortex_4seq_gene1_AA.fas",type="DNA")
inAas<-read.FASTA("CodeSeq_test1_onCortex_4seq_gene1_AA.fas",type="AA")
str(inNucs)
str(inAas)
str(inNucs)[1]
str(inNucs)[[1]]
str(inNucs)[[2]]
str(inNucs)[2]
x<-str(inNucs)
x
inNucs
?DNAbin
as.character(inNucs)
length(as.character(inNucs))
?length
str(as.character(inNucs))
length(str(as.character(inNucs)))
str(as.character(inNucs))
length(inNucs)
lengths(inNucs)
lengths(inAas)
sum(lengths(inAas))
sum(lengths(inAas))/length(inAas)
lengths(inAAs) == sum(lengths(inAas))/length(inAas)
lengths(inAAs) == (sum(lengths(inAas))/length(inAas))
lengths(inAAs)
lengths(inAas) == (sum(lengths(inAas))/length(inAas))
all(lengths(inAas) == (sum(lengths(inAas))/length(inAas)))
inNucs
inAas
all(lengths(inAAs == sum(lengths(inAAs))/length(inAAs))
all(lengths(inAas) == sum(lengths(inAas))/length(inAas))
all(lengths(inNucs) == sum(lengths(inNucs))/length(inNucs))
any(lengths(inNucs) == sum(lengths(inNucs))/length(inNucs))
lengths(inNucs) == sum(lengths(inNucs))/length(inNucs)
?all
?any
?complement
lengths(inNucs) == sum(lengths(inNucs))/length(inNucs)
lengths(inAas) == sum(lengths(inAas))/length(inAas)
lengths(inAas) == mean(lengths(inAas))
source("~/scripts/sequence_entropy_calculator.R")
source("~/scripts/sequence_entropy_calculator.R")
fasSeqType(fileName)
fasSeqType("Concat_inAAs.phy")
fasSeqType("CodeSeq_test1_onCortex_4seq_gene1_AA.fas")
source("~/scripts/sequence_entropy_calculator.R")
fasSeqType("CodeSeq_test1_onCortex_4seq_gene1_AA.fas")
fasSeqType("CodeSeq_test1_onCortex_4seq_gene1.fas")
fasSeqType("Concat_Lin1_inAAs.fst")
fasSeqType("Concat_Lin1_inNucs.fst")
source("~/scripts/sequence_entropy_calculator.R")
fasSeqType("Concat_Lin1_inAAs.fst")
fasSeqType("Concat_Lin1_inNucs.fst")
fasSeqType("Concat_inAAs.phy")
source("~/scripts/sequence_entropy_calculator.R")
fasSeqType("Concat_inAAs.phy")
?print
source("~/scripts/sequence_entropy_calculator.R")
fasSeqType("Concat_inAAs.phy")
source("~/scripts/sequence_entropy_calculator.R")
fasSeqType("Concat_inAAs.phy")
source("~/scripts/sequence_entropy_calculator.R")
fasSeqType("Concat_inAAs.phy")
source("~/scripts/sequence_entropy_calculator.R")
inSeq1<-readSeqAsChars("Concat_inAAs.phy")
inSeq1
inSeq1<-readSeqAsChars("Concat_inAAs.fas")
inSeq1<-readSeqAsChars("Concat_Lin1_inAAs.fst")
inSeq1
inSeq1<-readSeqAsChars("Concat_inNucs.phy")
inSeq1
inSeq1<-readSeqAsChars("Concat_Lin1_inNucs.fst")
inSeq1
inSeq1<-readSeqAsChars("Concat_Lin1_inNucs.phy")
inSeq1<-readSeqAsChars("CodeSeq_test1_onCortex_4seq_gene1.fas")
inSeq2<-readSeqAsChars("CodeSeq_test1_onCortex_4seq_gene1.phy")
inSeq1
inSeq2
as.DNAbin(inSeq2)
as.AAbin(inSeq2)
inSeqaa<-as.AAbin(inSeq2)
inSeqaa
inSeqaa[1]
str(inSeqaa)
inSeq2
inSeq2[,1]
inSeqaa[,1]
inSeq
inSeq2
str(inSeq2)
head(inSeq2,n=1)
str(inSeq2)
inSeq2[[1]]
inSeq2[1]
inSeq2
inSeq2[1,]
oner<-inSeq2[1,]
oner == "A"
oner == "A" || oner == "C" || oner == "G" || oner == "T"
freqs(inSeq2)
lengths(inSeq2)
lengths(inSeq1)
length(inSeq2)
inSeq2
inSeq2 == A
inSeq2 == "A"
sum(inSeq2 == "A")
bases<-c("A","T","G","C")
inSeq2 == bases
inseq2
inseq2
inseq2
inSeq2
sum(inSeq2 == bases)
sapply(bases,inSeq2 == bases)
sapply(bases,function() {inSeq2 == bases})
?sapply
totCount<-function(inVal,inDF) { x<-sum(inDF == inVal); return(x) }
sapply(bases,totCount)
sapply(bases,totCount,inSeq2)
?count
?count.fields
sapply(bases,totCount,inSeq2)
nucs<-sapply(bases,totCount,inSeq2)
inSeq1
inSeq1<-readSeqAsChars("CodeSeq_test1_onCortex_4seq_gene1_AA.fas")
inSeq2<-readSeqAsChars("CodeSeq_test1_onCortex_4seq_gene1.phy")
inSeq1
inSeq2
library(phytools)
library(phytools)
nucs<-sapply(bases,totCount,inSeq2)
nucs
aas<-sapply(bases,totCount,inSeq1)
aas
sum(aas)
sum(nucs)
length(inSeq1)
lengths(inSeq1)
lengths(inSeq2)
length(inSeq2)
length(inSeq2)*0.98
source("~/scripts/sequence_entropy_calculator.R")
source("~/scripts/sequence_entropy_calculator.R")
seqType(inSeq1)
seqType(inSeq2)
source("~/scripts/sequence_entropy_calculator.R")
x<-calcSiteEntropy(inSeq2)
y<-calcSiteEntropy(inSeq1)
x
x<-calcSequencentropy(inSeq2)
x<-calcSequenceEntropy(inSeq2)
source("~/scripts/sequence_entropy_calculator.R")
x<-calcSequenceEntropy(inSeq2)
y<-calcSequenceEntropy(inSeq1)
source("~/scripts/sequence_entropy_calculator.R")
calcSiteEntropy(inSeq1,"AA")
source("~/scripts/sequence_entropy_calculator.R")
calcSequenceEntropy(inSeq1,"AA")
source("~/scripts/sequence_entropy_calculator.R")
calcSequenceEntropy(inSeq1,"AA")
calcSiteEntropy(inSeq1[,3],"AA")
source("~/scripts/sequence_entropy_calculator.R")
calcSequenceEntropy(inSeq1)
source("~/scripts/sequence_entropy_calculator.R")
calcSequenceEntropy(inSeq1)
x<-calcSequenceEntropy(inSeq1)
plot(x)
y<-calcSequenceEntropy(inSeq2)
y
plot(y)
concatNucs<-readSeqAsChars("Concat_inNucs.phy")
concatAAs<-readSeqAsChars("Concat_inAAs.phy")
x<-calcSequenceEntropy(concatNucs)
y<-calcSequenceEntropy(concatAAs)
plot(x)
plot(y)
plot(x)
tot<-15000; for (i in 1:10) { abline(v=tot*(1/i)) }
plot(x)
tot<-15000; for (i in 1:10) { abline(v=tot*i*0.1,col="red") }
plot(y)
tot<-5000; for (i in 1:10) { abline(v=tot*i*0.1,col="red") }
q()
?write.csv
q()
interactive()
quit()
